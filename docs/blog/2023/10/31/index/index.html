<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Added deployment | Powershell Sync Profile</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-test-site.com/help/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-test-site.com/help/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/help/blog/2023/10/31/index"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Added deployment | Powershell Sync Profile"><meta data-rh="true" name="description" content="After this ADR"><meta data-rh="true" property="og:description" content="After this ADR"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-10-31T00:00:00.000Z"><link data-rh="true" rel="icon" href="/help/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/help/blog/2023/10/31/index"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/help/blog/2023/10/31/index" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/help/blog/2023/10/31/index" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/help/blog/rss.xml" title="Powershell Sync Profile RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/help/blog/atom.xml" title="Powershell Sync Profile Atom Feed"><link rel="stylesheet" href="/help/assets/css/styles.c52b59fd.css">
<link rel="preload" href="/help/assets/js/runtime~main.ec96887e.js" as="script">
<link rel="preload" href="/help/assets/js/main.aa9421f3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/help/"><div class="navbar__logo"><img src="/help/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/help/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">syncPowershellProfile</b></a><a class="navbar__item navbar__link" href="/help/docs/intro">Tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/help/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ignatandrei/syncPowershellProfile" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/11/01/index">Added CPM and ProjProperties</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/help/blog/2023/10/31/index">Added deployment</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/10/30/index">Added deployment</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/10/29/index">Added versioning</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/10/28/index">Adding WebAPI</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/10/12/index">Adding logging</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/31/index">Refactoring</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/30/index">Testing saving and retrieval</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/29/index">Analysis of the project</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/28/index">Code Coverage</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/27/index">Continuing tests - no data</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/26/index">Documentation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/25/index">Starting tests</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/24/index">Use Cases as mermaid</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/23/index">General Architecture</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/22/index">Use Cases</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/21/index">Work on documentation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/20/index">Documentation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/2023/08/19/index">Start project</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/welcome">Welcome</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/mdx-blog-post">MDX Blog Post</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/long-blog-post">Long Blog Post</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/help/blog/first-blog-post">First Blog Post</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Added deployment</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-10-31T00:00:00.000Z" itemprop="datePublished">October 31, 2023</time> · <!-- -->2 min read</div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>After this ADR </p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="title-adr-007---exception-handling">TITLE: ADR 007 - Exception Handling<a href="#title-adr-007---exception-handling" class="hash-link" aria-label="Direct link to TITLE: ADR 007 - Exception Handling" title="Direct link to TITLE: ADR 007 - Exception Handling">​</a></h2><ul><li><p>Status: accepted </p></li><li><p>Deciders: <!-- -->[&quot;Andrei Ignat&quot;]</p></li><li><p>Date: <!-- -->[2023-11-05]</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="context-and-problem-statement">Context and Problem Statement<a href="#context-and-problem-statement" class="hash-link" aria-label="Direct link to Context and Problem Statement" title="Direct link to Context and Problem Statement">​</a></h2><p>In every program we need to handle the unexpected situations. One of those are configuration errors.
Others are network errors, database errors, etc. However, there are many situations where the errors are of our own - like a bug in the code, errors in the database and so on...</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="decision-drivers">Decision Drivers<a href="#decision-drivers" class="hash-link" aria-label="Direct link to Decision Drivers" title="Direct link to Decision Drivers">​</a></h2><p>In order to make a difference between the errors that are of our own and the errors that are not of our own, we need to have a way to handle them differently. That&#x27;s why a custom exception is needed.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="decision-outcome">Decision Outcome<a href="#decision-outcome" class="hash-link" aria-label="Direct link to Decision Outcome" title="Direct link to Decision Outcome">​</a></h2><p>Chosen option: &quot;Use a custom exception&quot; every time when the error is of our own. Also, use a custom exception when the error is not of our own, but we want to handle it differently. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="positive-consequences">Positive Consequences<a href="#positive-consequences" class="hash-link" aria-label="Direct link to Positive Consequences" title="Direct link to Positive Consequences">​</a></h2><p>Internal errors are handled differently than external errors. And some corrective measures can be applied.</p><ol><li><p><strong>Domain-Specific Errors:</strong> When you have errors that are specific to your business logic or domain, custom exceptions can be used to represent these errors.</p></li><li><p><strong>Complex Error Handling:</strong> If your application has complex error handling requirements, custom exceptions can be used to differentiate between different types of errors.</p></li><li><p><strong>Enhanced Error Information:</strong> If you need to include additional information in your exceptions (like error codes or additional context), custom exceptions can be used.</p></li><li><p><strong>Control Flow:</strong> In some cases, custom exceptions can be used as a form of control flow. This is generally discouraged, but there are some scenarios where it can be useful.</p></li><li><p><strong>Third-Party Library Errors:</strong> If you&#x27;re using a third-party library that throws generic exceptions, you might want to catch those and throw your own custom exceptions instead. This can make your error handling code more consistent and easier to understand.</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="negative-consequences">Negative Consequences<a href="#negative-consequences" class="hash-link" aria-label="Direct link to Negative Consequences" title="Direct link to Negative Consequences">​</a></h2><ol><li><p><strong>Loss of Inner Exception:</strong> If not handled properly, the inner exception that caused the custom exception might be lost, making it harder to debug the issue - or should be added to help the developer to understand the error.</p></li><li><p><strong>Increased Development Time:</strong> Creating and maintaining custom exceptions can increase development time.</p></li><li><p><strong>Potential for Misuse:</strong> Custom exceptions can be misused or overused, leading to unnecessary complexity.</p></li><li><p><strong>Learning Curve:</strong> Other developers unfamiliar with the custom exceptions might have a learning curve to understand them.</p></li><li><p><strong>Dependency:</strong> If the custom exceptions are part of a library that is used across multiple projects, changes to the exceptions can impact all these projects.</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pros-and-cons-of-the-options">Pros and Cons of the Options<a href="#pros-and-cons-of-the-options" class="hash-link" aria-label="Direct link to Pros and Cons of the Options" title="Direct link to Pros and Cons of the Options">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pros-of-using-custom-exceptions">Pros of Using Custom Exceptions<a href="#pros-of-using-custom-exceptions" class="hash-link" aria-label="Direct link to Pros of Using Custom Exceptions" title="Direct link to Pros of Using Custom Exceptions">​</a></h3><ol><li><strong>Specificity:</strong> Custom exceptions provide more specific error information, making it easier to understand and handle the error.</li><li><strong>Control:</strong> They allow for more control over error handling, as you can create different exceptions for different error conditions.</li><li><strong>Clarity:</strong> They can make the code more readable and maintainable, as the exception names can reflect the error conditions they represent.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cons-of-using-custom-exceptions">Cons of Using Custom Exceptions<a href="#cons-of-using-custom-exceptions" class="hash-link" aria-label="Direct link to Cons of Using Custom Exceptions" title="Direct link to Cons of Using Custom Exceptions">​</a></h3><ol><li><strong>Complexity:</strong> Creating custom exceptions can add complexity to the code, especially if overused.</li><li><strong>Maintenance:</strong> They require more maintenance. If the error conditions change, the custom exceptions also need to be updated.</li><li><strong>Standardization:</strong> Using standard exceptions can sometimes be more straightforward and less error-prone, as they are widely recognized and understood by most developers.</li></ol><p>I have created the custom exception base class</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">namespace syncPowershellException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract class BaseAppException: Exception</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public BaseAppException(string message): base(message)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public BaseAppException(string message, Exception inner)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        : base(message, inner)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I resisted to the temptation to create a custom exception for every error.  Example : </p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ArgumentNullException.ThrowIfNull(data);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>should be left as it is.</p><p>Instead ,look at this example:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public async Task&lt;DataToBeSent&gt; GetData()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var powershell7Profile =environment.GetFolderPath( Environment.SpecialFolder.MyDocuments );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    powershell7Profile = path.Combine(powershell7Profile, &quot;WindowsPowerShell&quot;, &quot;Microsoft.PowerShell_profile.ps1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DataToBeSent dataToBeSent = new ();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dataToBeSent.UserName=environment.UserName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dataToBeSent.PC = environment.MachineName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (file.Exists(powershell7Profile))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dataToBeSent.Powershell = await file.ReadAllTextAsync(powershell7Profile, CancellationToken.None);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dataToBeSent.PowershellNumber = 7;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return dataToBeSent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If the file does not exists , then an error must be thrown. </p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class PowershellProfileNotExistsException : BaseAppException</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public readonly string fileName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public PowershellProfileNotExistsException(string fileName) : base($&quot;file {fileName} does not exists&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.fileName = fileName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And the code will be modified like this:</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public async Task&lt;DataToBeSent&gt; GetData()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var powershell7Profile =environment.GetFolderPath( Environment.SpecialFolder.MyDocuments );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    powershell7Profile = path.Combine(powershell7Profile, &quot;WindowsPowerShell&quot;, &quot;Microsoft.PowerShell_profile.ps1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DataToBeSent dataToBeSent = new ();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dataToBeSent.UserName=environment.UserName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dataToBeSent.PC = environment.MachineName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!file.Exists(powershell7Profile))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throw new PowershellProfileNotExistsException(powershell7Profile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dataToBeSent.Powershell = await file.ReadAllTextAsync(powershell7Profile, CancellationToken.None);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dataToBeSent.PowershellNumber = 7;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return dataToBeSent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Also the test will be modified from</p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DataGatherer gatherer = new(en.Instance(), file.Instance(),path.Instance(), logger);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data = await gatherer.GetData();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data.Should().NotBeNull();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>to </p><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DataGatherer gatherer = new(en.Instance(), file.Instance(),path.Instance(), logger);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var X=async ()=&gt; (await gatherer.GetData());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await X.Should().ThrowAsync&lt;PowershellProfileNotExistsException&gt;();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/help/blog/2023/11/01/index"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Added CPM and ProjProperties</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/help/blog/2023/10/30/index"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Added deployment</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/help/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/ignatandrei/syncPowershellProfile/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/help/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/ignatandrei/syncPowershellProfile" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 syncPowershellProfile, Built with Docusaurus.</div></div></div></footer></div>
<script src="/help/assets/js/runtime~main.ec96887e.js"></script>
<script src="/help/assets/js/main.aa9421f3.js"></script>
</body>
</html>